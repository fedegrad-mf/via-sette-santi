---
/**
 * Trails Section Component
 * 
 * Displays a grid of trail cards with all available trekking routes.
 * Automatically sorts trails by number and renders them in a responsive grid.
 * 
 * Props:
 * @param {string} title - Section title
 * @param {string} subtitle - Section subtitle
 * @param {Array} trails - Array of trail collection entries
 * @param {string} lang - Current language code
 * @param {object} translations - Translation strings for TrailCard component
 */

import { getRelativeLocaleUrl } from "astro:i18n";
import TrailCard from "./TrailCard.astro";

export interface Props {
	title: string;
	subtitle: string;
	trails: any[]; // Collection entries
	lang: string;
	class?: string;
	translations: {
		distance: string;
		duration: string;
		difficulty: string;
		viewDetails: string;
		easy: string;
		moderate: string;
		hard: string;
		stageLabel: string;
	};
}

const { title, subtitle, trails, lang, translations, class: className } = Astro.props;

// Sort trails by number
const sortedTrails = trails.sort((a, b) => a.data.number - b.data.number);

// Helper function to get difficulty label
const getDifficultyLabel = (difficulty: string): string => {
	switch (difficulty) {
		case 'easy':
			return translations.easy;
		case 'moderate':
			return translations.moderate;
		case 'hard':
			return translations.hard;
		default:
			return difficulty;
	}
};
---

<section id="trails" class:list={["section", className]}>
	<div class="container-custom section-content-center">
		<div class="section-header">
			<h2 class="section-title">{title}</h2>
			<p class="section-subtitle">{subtitle}</p>
		</div>

		<div class="grid-responsive">
			{sortedTrails.map((trail) => (
				<TrailCard
					number={trail.data.number}
					title={trail.data.title}
					description={trail.data.description}
					distance={trail.data.distance}
					duration={trail.data.duration}
					difficulty={trail.data.difficulty}
					image={trail.data.image}
					link={getRelativeLocaleUrl(lang, `/trails/${trail.id.split('/').slice(1).join('/')}`)}
					translations={{
						distance: translations.distance,
						duration: translations.duration,
						difficulty: translations.difficulty,
						viewDetails: translations.viewDetails,
					difficultyLabel: getDifficultyLabel(trail.data.difficulty),
					stageLabel: translations.stageLabel
					}}
				/>
			))}
		</div>
	</div>
</section>
